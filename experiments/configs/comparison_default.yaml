# Controller comparison configuration
# Use this config to generate side-by-side metrics for PID, LQR, and Deep controllers.
#
# Usage with Makefile:
#   make compare-controllers CONFIG=experiments/configs/comparison_default.yaml
#
# Manual usage:
#   # Run comparison sweep
#   python -m quadcopter_tracking.eval --sweep experiments/configs/comparison_default.yaml
#
# Output:
#   - reports/comparison/sweep_results.json - Ranked results for all controllers
#   - reports/comparison/<controller>/metrics.json - Per-controller metrics
#   - reports/comparison/<controller>/plots/*.png - Visualization plots

# =============================================================================
# Shared Configuration (YAML Anchors)
# =============================================================================
# These anchors define shared values that are reused across controller configs.
# To modify all controllers, change the anchor definition here.

# Shared evaluation parameters - modify here to change all controllers
shared_eval: &shared_eval
  num_episodes: 10
  seed: 42
  motion_type: circular
  episode_length: 30.0
  target_radius: 0.5

# Validated baseline PID gains - referenced from training_default.yaml
# XY gains are small (meter→rad/s mapping) to prevent actuator saturation
shared_pid_gains: &shared_pid_gains
  kp_pos: [0.01, 0.01, 4.0]    # Low XY gains (meter→rad/s mapping)
  ki_pos: [0.0, 0.0, 0.0]      # Zero integral to avoid wind-up
  kd_pos: [0.06, 0.06, 2.0]    # Low XY damping
  integral_limit: 0.0

# Validated baseline LQR weights - referenced from training_default.yaml
# Low XY position costs prevent saturation due to meter→rad/s mapping
shared_lqr_weights: &shared_lqr_weights
  q_pos: [0.0001, 0.0001, 16.0]  # Low XY position cost
  q_vel: [0.0036, 0.0036, 4.0]   # Velocity cost for damping
  r_thrust: 1.0
  r_rate: 1.0

# =============================================================================
# Comparison Configuration
# =============================================================================
# List of controller configurations to compare
# Each configuration runs the same number of episodes with identical seeds

configurations:
  # PID Controller - Classical proportional-integral-derivative control
  - name: pid_baseline
    controller_type: pid
    <<: *shared_eval
    pid:
      <<: *shared_pid_gains

  # LQR Controller - Linear Quadratic Regulator (optimal linear control)
  - name: lqr_baseline
    controller_type: lqr
    <<: *shared_eval
    lqr:
      <<: *shared_lqr_weights

  # Deep Controller - Neural network policy (requires trained checkpoint)
  # Uncomment and update checkpoint_path after training a model
  # The checkpoint filename is generated during training - check checkpoints/
  # for the actual filename (e.g., train_20240115_143022_42_best.pt)
  # - name: deep_trained
  #   controller_type: deep
  #   checkpoint_path: checkpoints/train_*_best.pt  # Update with actual filename
  #   <<: *shared_eval

# =============================================================================
# Output Configuration
# =============================================================================
output_dir: reports/comparison
generate_plots: true

# =============================================================================
# Comparison Metrics
# =============================================================================
# The comparison report will include these metrics for each controller:
#
# Primary Metrics:
#   - success_rate: Fraction of episodes meeting success criteria
#   - mean_on_target_ratio: Average time within target radius
#   - mean_tracking_error: Average distance to target (meters)
#
# Secondary Metrics:
#   - std_on_target_ratio: Consistency measure
#   - std_tracking_error: Error variance
#   - mean_control_effort: Average control magnitude
#
# Rankings are sorted by success_rate (primary) and mean_on_target_ratio (secondary)
